<!doctype html>
<html lang="en">
<head>
  <!-- Require meta tags -->
  <meta charset="utf-8">
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
    integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
    crossorigin="anonymous">
  <!-- Font Awesome Icons -->
  <script
    defer
    src="https://use.fontawesome.com/releases/v5.0.10/js/all.js"
    integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+"
    crossorigin="anonymous"></script>
  <style>
    .dropdown {
      max-width: 250px;
    }
    label {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 0;
    }
  </style>
  <!-- Page Title -->
  <title>Foe Finder | Survey</title>
</head>
<body>

  <div class="container mb-5">
    <h1 class="display-1">Survey</h1>
    <!-- Survey Form -->
    <form class="border p-3">
      <!-- User Name -->
      <div class="form-group">
        <label for="name">Name</label>
        <input
          required
          id="name"
          type="text"
          class="form-control"
          placeholder="ex. J-Son">
      </div>
      <!-- User Image Link -->
      <div class="form-group">
        <label for="photo">Link to photo</label>
        <input
          required
          id="photo"
          type="url"
          class="form-control"
          placeholder="ex. www.example.com/my-picture">
      </div>
      <!-- User Witty Quip -->
      <div class="form-group">
        <label for="quip">Witty Quip</label>
        <input
          required
          id="quip"
          type="text"
          class="form-control"
          placeholder="ex. Get your facts first, then you can distort them as you please">
      </div>
      <hr class="mt-4 mb-2">
      <!-- Question #1 -->
      <div class="form-group">
        <label for="q1">Kittens make the best evil pets</label>
        <select required class="form-control dropdown" id="q1">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #2 -->
      <div class="form-group">
        <label for="q2">A good sense of humor is always appreciated</label>
        <select required class="form-control dropdown" id="q2">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #3 -->
      <div class="form-group">
        <label for="q3">One should not abstain from eating brains</label>
        <select required class="form-control dropdown" id="q3">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #4 -->
      <div class="form-group">
        <label for="q4">A circus is a fun place to be</label>
        <select required class="form-control dropdown" id="q4">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #5 -->
      <div class="form-group">
        <label for="q5">Oh what fun casting spells can be</label>
        <select required class="form-control dropdown" id="q5">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #6 -->
      <div class="form-group">
        <label for="q6">Everyone needs a miniature clone of themselves</label>
        <select required class="form-control dropdown" id="q6">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #7 -->
      <div class="form-group">
        <label for="q7">To be fearful of bats is wise</label>
        <select required class="form-control dropdown" id="q7">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #8 -->
      <div class="form-group">
        <label for="q8">Criminal insanity is no reason for incarcertation</label>
        <select required class="form-control dropdown" id="q8">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #9 -->
      <div class="form-group">
        <label for="q9">One should avoid clowns with fangs</label>
        <select required class="form-control dropdown" id="q9">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- Question #10 -->
      <div class="form-group">
        <label for="q10">One should strive for immortality through magical means</label>
        <select required class="form-control dropdown" id="q10">
          <option value="" disabled selected>Select an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <!-- SUBMIT button -->
      <button id="submitSurvey" type="submit" class="btn btn-primary w-100">Submit</button>
    </form><!-- End 'Survey Form' -->
  </div><!-- End Div 'container' -->
  <!-- Results modal -->
  <div class="modal fade" id="resultsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalCenterTitle">Your Arch Enemy</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- Arch Enemy data to appear here -->
        </div>
      </div>
    </div>
  </div>
  <!-- End 'Results modal' -->
  <footer class="fixed-bottom text-center pb-2">
    <a href="/api/friends" class="text-dark">API Friends List</a>&nbsp;|
    <a href="https://github.com/BenRGarcia/Foe-Finder" class="text-dark">&nbsp;<i class="fab fa-github"></i>&nbsp;Source Code</a>
  </footer>
  <!-- jQuery -->
  <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <!-- Popper -->
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
    integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
    crossorigin="anonymous"></script>
  <!-- Bootstrap -->
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"
    integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
    crossorigin="anonymous"></script>
  <script>
    /**
     * FORM LOGIC
     */
    function test() {
      $('#resultsModal').modal("show");
    }
    // Shorthand for $( document ).ready()
    $(function () {
      // When completed form is submitted
      $('form').on('submit', (e) => {
        // Prevent default reloading of page
        e.preventDefault();
        // Gather values from survey
        const newUser = {
          name: $("#name").val().trim(),
          photo: $("#photo").val().trim(),
          quip: $("#quip").val().trim(),
          scores: [
            $("#q1").val(), 
            $("#q2").val(), 
            $("#q3").val(), 
            $("#q4").val(), 
            $("#q5").val(), 
            $("#q6").val(), 
            $("#q7").val(), 
            $("#q8").val(), 
            $("#q9").val(), 
            $("#q10").val(),
          ]
        };
        // Clear input values from window
        $("#name").val("");
        $("#photo").val("");
        $("#quip").val("");
        $("#q1").val("");
        $("#q2").val("");
        $("#q3").val("");
        $("#q4").val("");
        $("#q5").val("");
        $("#q6").val("");
        $("#q7").val("");
        $("#q8").val("");
        $("#q9").val("");
        $("#q10").val("");
        console.log(newUser);
        // Send post request
        $.post('/api/friends', newUser)
          .then( archEnemy => {
            // Render response object to modal
            let name = `<h2>${archEnemy.name}</h2>`;
            let img = `<img src="${archEnemy.photo}" class="img-fluid mb-2">`;
            let quip = `<p>${archEnemy.quip}</p>`;
            $('.modal-body').append(name, img, quip);
            // Show modal
            $('#resultsModal').modal("show");
          })
          .catch(err => console.error(err));
      });
    });
  </script>
</body>
</html>